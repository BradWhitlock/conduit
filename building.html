

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building &mdash; Conduit 0.2.0.pre documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Conduit 0.2.0.pre documentation" href="index.html"/>
        <link rel="up" title="User Documentation" href="user.html"/>
        <link rel="next" title="Glossary" href="glossary.html"/>
        <link rel="prev" title="mesh" href="blueprint_mesh.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Conduit
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0.pre
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="user.html">User Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="conduit.html">Conduit</a></li>
<li class="toctree-l2"><a class="reference internal" href="relay.html">Relay</a></li>
<li class="toctree-l2"><a class="reference internal" href="blueprint.html">Blueprint</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-options">Build Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-path-options">Installation Path Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#host-config-files">Host Config Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bootstrapping-third-party-dependencies">Bootstrapping Third Party Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compiler-settings-for-third-party-dependencies">Compiler Settings for Third Party Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-with-spack">Building with Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-conduit-in-another-project">Using Conduit in Another Project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentations.html">Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="licenses.html">License Info</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Conduit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="user.html">User Documentation</a> &raquo;</li>
      
    <li>Building</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/building.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building">
<span id="id1"></span><h1>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Clone the Conduit repo:</p>
<ul class="simple">
<li>From Github</li>
</ul>
<div class="code bash highlight-default"><div class="highlight"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llnl</span><span class="o">/</span><span class="n">conduit</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ul class="simple">
<li>From LLNL&#8217;s CZ Stash Instance (LLNL Users)</li>
</ul>
<div class="code bash highlight-default"><div class="highlight"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="p">{</span><span class="n">USER_NAME</span><span class="p">}</span><span class="nd">@lc</span><span class="o">.</span><span class="n">llnl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">stash</span><span class="o">/</span><span class="n">scm</span><span class="o">/</span><span class="n">con</span><span class="o">/</span><span class="n">conduit</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Configure a build:</p>
<p><code class="docutils literal"><span class="pre">config-build.sh</span></code> is a simple wrapper for the cmake call to configure conduit.
This creates a new out-of-source build directory <code class="docutils literal"><span class="pre">build-debug</span></code> and a directory for the install <code class="docutils literal"><span class="pre">install-debug</span></code>.
It will optionally include a <code class="docutils literal"><span class="pre">host-config.cmake</span></code> file with detailed configuration options.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span class="n">cd</span> <span class="n">conduit</span>
<span class="o">./</span><span class="n">config</span><span class="o">-</span><span class="n">build</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Build, test, and install Conduit:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span class="n">cd</span> <span class="n">build</span><span class="o">-</span><span class="n">debug</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span>
<span class="n">make</span> <span class="n">test</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
</div>
<div class="section" id="build-options">
<h2>Build Options<a class="headerlink" href="#build-options" title="Permalink to this headline">¶</a></h2>
<p>The core Conduit library has no dependencies outside of the repo, however Conduit provides optional support for I/O and Communication (MPI) features that require externally built third party libraries.</p>
<p>Conduit&#8217;s build system supports the following CMake options:</p>
<ul class="simple">
<li><strong>BUILD_SHARED_LIBS</strong> - Controls if shared (ON) or static (OFF) libraries are built. <em>(default = ON)</em></li>
<li><strong>ENABLE_TESTS</strong> - Controls if unit tests are built. <em>(default = ON)</em></li>
<li><strong>ENABLE_DOCS</strong> - Controls if the Conduit documentation is built (when sphinx and doxygen are found ). <em>(default = ON)</em></li>
<li><strong>ENABLE_COVERAGE</strong> - Controls if code coverage compiler flags are used to build Conduit. <em>(default = OFF)</em></li>
<li><strong>ENABLE_PYTHON</strong> - Controls if the Conduit Python module is built. <em>(default = OFF)</em></li>
</ul>
<blockquote>
<div>The Conduit Python module will build for both Python 2 and Python 3. To select a specific Python, set the CMake variable <strong>PYTHON_EXECUTABLE</strong> to path of the desired python binary. The Conduit Python module requires Numpy. The selected Python instance must provide Numpy, or PYTHONPATH must be set to include a Numpy install compatible with the selected Python install.</div></blockquote>
<ul class="simple">
<li><strong>ENABLE_MPI</strong> - Controls if the conduit_relay_mpi library is built. <em>(default = OFF)</em></li>
</ul>
<blockquote>
<div><p>We are using CMake&#8217;s standard FindMPI logic. To select a specific MPI set the CMake variables <strong>MPI_C_COMPILER</strong> and <strong>MPI_CXX_COMPILER</strong>, or the other FindMPI options for MPI include paths and MPI libraries.</p>
<p>To run the mpi unit tests on LLNL&#8217;s LC platforms, you may also need change the CMake variables <strong>MPIEXEC</strong> and <strong>MPIEXEC_NUMPROC_FLAG</strong>, so you can use srun and select a partition. (for an example see: src/host-configs/chaos_5_x86_64.cmake)</p>
</div></blockquote>
<ul class="simple">
<li><strong>HDF5_DIR</strong> - Path to a HDF5 install <em>(optional)</em>.</li>
</ul>
<blockquote>
<div>Controls if HDF5 I/O support is built into <em>conduit_relay</em>.</div></blockquote>
<ul class="simple">
<li><strong>SILO_DIR</strong> - Path to a Silo install <em>(optional)</em>.</li>
</ul>
<blockquote>
<div><p>Controls if Silo I/O support is built into <em>conduit_relay</em>. When used, the following CMake variables must also be set:</p>
<ul class="simple">
<li><strong>HDF5_DIR</strong> - Path to a HDF5 install. (Silo support depends on HDF5)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="installation-path-options">
<h2>Installation Path Options<a class="headerlink" href="#installation-path-options" title="Permalink to this headline">¶</a></h2>
<p>Conduit&#8217;s build system provides an <strong>install</strong> target that installs the Conduit libraires, headers, python modules, and documentation. These CMake options allow you to control install destination paths:</p>
<ul class="simple">
<li><strong>CMAKE_INSTALL_PREFIX</strong> - Standard CMake install path option <em>(optional)</em>.</li>
<li><strong>PYTHON_MODULE_INSTALL_PREFIX</strong> - Path to install Python modules into <em>(optional)</em>.</li>
</ul>
<blockquote>
<div>When present and <strong>ENABLE_PYTHON</strong> is ON, Conduit&#8217;s Python modules will be installed to <code class="docutils literal"><span class="pre">${PYTHON_MODULE_INSTALL_PREFIX}</span></code> directory instead of <code class="docutils literal"><span class="pre">${CMAKE_INSTALL_PREFIX}/python-modules</span></code>.</div></blockquote>
</div>
<div class="section" id="host-config-files">
<h2>Host Config Files<a class="headerlink" href="#host-config-files" title="Permalink to this headline">¶</a></h2>
<p>To handle build options, third party library paths, etc we rely on CMake&#8217;s initial-cache file mechanism.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span class="n">cmake</span> <span class="o">-</span><span class="n">C</span> <span class="n">config_file</span><span class="o">.</span><span class="n">cmake</span>
</pre></div>
</div>
<p>We call these initial-cache files <em>host-config</em> files, since we typically create a file for each platform or specific hosts if necessary.</p>
<p>The <code class="docutils literal"><span class="pre">config-build.sh</span></code> script will use your machine&#8217;s hostname, the SYS_TYPE environment variable, and your platform name (via <em>uname</em>) to look for an existing host config file in the <code class="docutils literal"><span class="pre">host-configs</span></code> directory at the root of the conduit repo. If found, it will pass the host config file to CMake via the <cite>-C</cite> command line option.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span class="n">cmake</span> <span class="p">{</span><span class="n">other</span> <span class="n">options</span><span class="p">}</span> <span class="o">-</span><span class="n">C</span> <span class="n">host</span><span class="o">-</span><span class="n">configs</span><span class="o">/</span><span class="p">{</span><span class="n">config_file</span><span class="p">}</span><span class="o">.</span><span class="n">cmake</span> <span class="o">../</span>
</pre></div>
</div>
<p>You can find example files in the <code class="docutils literal"><span class="pre">host-configs</span></code> directory.</p>
<p>These files use standard CMake commands. CMake <em>set</em> commands need to specify the root cache path as follows:</p>
<div class="code cmake highlight-default"><div class="highlight"><pre><span class="nb">set</span><span class="p">(</span><span class="n">CMAKE_VARIABLE_NAME</span> <span class="p">{</span><span class="n">VALUE</span><span class="p">}</span> <span class="n">CACHE</span> <span class="n">PATH</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bootstrapping-third-party-dependencies">
<h2>Bootstrapping Third Party Dependencies<a class="headerlink" href="#bootstrapping-third-party-dependencies" title="Permalink to this headline">¶</a></h2>
<p>You can use <code class="docutils literal"><span class="pre">bootstrap-env.sh</span></code> (located at the root of the conduit repo) to help setup your development environment on OSX and Linux. This script uses <code class="docutils literal"><span class="pre">scripts/uberenv/uberenv.py</span></code>, which leverages <strong>Spack</strong> (<a class="reference external" href="http://software.llnl.gov/spack">http://software.llnl.gov/spack</a>) to build the external third party libraries and tools used by Conduit. Fortran support in is optional, dependencies should build without fortran. After building these libraries and tools, it writes an initial <em>host-config</em> file and adds the Spack built CMake binary to your PATH, so can immediately call the <code class="docutils literal"><span class="pre">config-build.sh</span></code> helper script to configure a conduit build.</p>
<div class="code bash highlight-default"><div class="highlight"><pre>#build third party libs using spack
source bootstrap-env.sh

#copy the generated host-config file into the standard location
cp uberenv_libs/`hostname`*.cmake to host-configs/

# run the configure helper script
./config-build.sh

# or you can run the configure helper script and give it the
# path to a host-config file
./config-build.sh uberenv_libs/`hostname`*.cmake
</pre></div>
</div>
<div class="section" id="compiler-settings-for-third-party-dependencies">
<h3>Compiler Settings for Third Party Dependencies<a class="headerlink" href="#compiler-settings-for-third-party-dependencies" title="Permalink to this headline">¶</a></h3>
<p>You can edit <code class="docutils literal"><span class="pre">scripts/uberenv/compilers.yaml</span></code> to change the compiler settings
passed to Spack. See the <a class="reference external" href="http://software.llnl.gov/spack/basic_usage.html#manual-compiler-configuration">Spack Compiler Configuration</a>
documentation for details.</p>
<p>For OSX, the defaults in <code class="docutils literal"><span class="pre">compilers.yaml</span></code> are clang from X-Code and gfortran from <a class="reference external" href="https://gcc.gnu.org/wiki/GFortranBinaries#MacOS">https://gcc.gnu.org/wiki/GFortranBinaries#MacOS</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The bootstrapping process ignores <code class="docutils literal"><span class="pre">~/.spack/compilers.yaml</span></code> to avoid conflicts
and surprises from a user&#8217;s specific Spack settings on HPC platforms.</p>
</div>
</div>
</div>
<div class="section" id="building-with-spack">
<h2>Building with Spack<a class="headerlink" href="#building-with-spack" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Conduit developers use <code class="docutils literal"><span class="pre">scripts/uberenv/uberenv.py</span></code> to setup third party libraries for Conduit
development.  Due to this, the process builds more libraries than necessary for most use cases.
For example, we build independent installs of Python 2 and Python 3 to make it easy
to check Python C-API compatibility during development. In the near future, we plan to
provide a Spack package to simplify deployment.</p>
</div>
</div>
<div class="section" id="using-conduit-in-another-project">
<h2>Using Conduit in Another Project<a class="headerlink" href="#using-conduit-in-another-project" title="Permalink to this headline">¶</a></h2>
<p>Under <code class="docutils literal"><span class="pre">src/examples</span></code>, you can find examples demonstrating how to use Conduit in a CMake-based build system (<code class="docutils literal"><span class="pre">using-with-cmake</span></code>) and via a Makefile (<code class="docutils literal"><span class="pre">using-with-make</span></code>).</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="glossary.html" class="btn btn-neutral float-right" title="Glossary" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blueprint_mesh.html" class="btn btn-neutral" title="mesh" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2016, LLNS.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.0.pre',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>